#include "opensimplex2s.h"
#include <stdlib.h>

const long PRIME_X = 0x5205402B9270C86FL;
const long PRIME_Y = 0x598CD327003817B5L;
const long PRIME_Z = 0x5BCC226E9FA0BACBL;
const long PRIME_W = 0x56CC5227E58F554BL;
const long HASH_MULTIPLIER = 0x53AF72DEEC546F5L;
const long SEED_FLIP_3D = -0x52D547B2E96ED629L;

const double ROOT2OVER2 = 0.7071067811865476;
const double SKEW_2D = 0.366025403784439;
const double UNSKEW_2D = -0.21132486540518713;

const double ROOT3OVER3 = 0.577350269189626;
const double FALLBACK_ROTATE3 = 2.0 / 3.0;
const double ROTATE3_ORTOGANALIZER = UNSKEW_2D;

const float SKEW_4D = 0.309016994374947f;
const float UNSKEW_4D = -0.138196601125011f;

const int N_GRADS_2D_EXPONENT = 7;
const int N_GRADS_3D_EXPONENT = 8;
const int N_GRADS_4D_EXPONENT = 9;
const int N_GRADS_2D = 1 << N_GRADS_2D_EXPONENT;
const int N_GRADS_3D = 1 << N_GRADS_3D_EXPONENT;
const int N_GRADS_4D = 1 << N_GRADS_4D_EXPONENT;

const double NORMALIZER_2D = 0.05481866495625118;
const double NORMALIZER_3D = 0.2781926117527186;
const double NORMALIZER_4D = 0.11127401889945551;

const float RSQUARED_2D = 2.0f / 3.0f;
const float RSQUARED_3D = 3.0f / 4.0f;
const float RSQUARED_4D = 4.0f / 5.0f;

typedef struct {
  float dx, dy, dz, dw;
  long xsvp, ysvp, zsvp, wsvp;
} LatticeVertex4D;

LatticeVertex4D makeLatticeVertex4D(int xsv, int ysv, int zsv, int wsv) {
  LatticeVertex4D latticeVertex4D;
  latticeVertex4D.xsvp = xsv * PRIME_X;
  latticeVertex4D.ysvp = ysv * PRIME_Y;
  latticeVertex4D.zsvp = zsv * PRIME_Z;
  latticeVertex4D.wsvp = wsv * PRIME_W;
  float ssv = (xsv + ysv + zsv + wsv) * UNSKEW_4D;
  latticeVertex4D.dx = -xsv - ssv;
  latticeVertex4D.dy = -ysv - ssv;
  latticeVertex4D.dz = -zsv - ssv;
  latticeVertex4D.dw = -wsv - ssv;
  return latticeVertex4D;
}

float GRADIENTS_2D[128 * 2];
float GRADIENTS_3D[256 * 4];
float GRADIENTS_4D[512 * 4];
int LOOKUP_4D_A[256];
LatticeVertex4D *LOOKUP_4D_B;

void opensimplex_init() {
  float grad2[] = {
      0.38268343236509f,
      0.923879532511287f,
      0.923879532511287f,
      0.38268343236509f,
      0.923879532511287f,
      -0.38268343236509f,
      0.38268343236509f,
      -0.923879532511287f,
      -0.38268343236509f,
      -0.923879532511287f,
      -0.923879532511287f,
      -0.38268343236509f,
      -0.923879532511287f,
      0.38268343236509f,
      -0.38268343236509f,
      0.923879532511287f,
      //-------------------------------------//
      0.130526192220052f,
      0.99144486137381f,
      0.608761429008721f,
      0.793353340291235f,
      0.793353340291235f,
      0.608761429008721f,
      0.99144486137381f,
      0.130526192220051f,
      0.99144486137381f,
      -0.130526192220051f,
      0.793353340291235f,
      -0.60876142900872f,
      0.608761429008721f,
      -0.793353340291235f,
      0.130526192220052f,
      -0.99144486137381f,
      -0.130526192220052f,
      -0.99144486137381f,
      -0.608761429008721f,
      -0.793353340291235f,
      -0.793353340291235f,
      -0.608761429008721f,
      -0.99144486137381f,
      -0.130526192220052f,
      -0.99144486137381f,
      0.130526192220051f,
      -0.793353340291235f,
      0.608761429008721f,
      -0.608761429008721f,
      0.793353340291235f,
      -0.130526192220052f,
      0.99144486137381f,
  };

  for (size_t i = 0; i < (sizeof(grad2) / sizeof(float)); ++i) {
    grad2[i] = (float)(grad2[i] / NORMALIZER_2D);
  }
  for (size_t i = 0, j = 0; i < (sizeof(GRADIENTS_2D) / sizeof(float));
       ++i, ++j) {
    if (j == (sizeof(grad2) / sizeof(float)))
      j = 0;
    GRADIENTS_2D[i] = grad2[j];
  }

  float grad3[] = {
      2.22474487139f,
      2.22474487139f,
      -1.0f,
      0.0f,
      2.22474487139f,
      2.22474487139f,
      1.0f,
      0.0f,
      3.0862664687972017f,
      1.1721513422464978f,
      0.0f,
      0.0f,
      1.1721513422464978f,
      3.0862664687972017f,
      0.0f,
      0.0f,
      -2.22474487139f,
      2.22474487139f,
      -1.0f,
      0.0f,
      -2.22474487139f,
      2.22474487139f,
      1.0f,
      0.0f,
      -1.1721513422464978f,
      3.0862664687972017f,
      0.0f,
      0.0f,
      -3.0862664687972017f,
      1.1721513422464978f,
      0.0f,
      0.0f,
      -1.0f,
      -2.22474487139f,
      -2.22474487139f,
      0.0f,
      1.0f,
      -2.22474487139f,
      -2.22474487139f,
      0.0f,
      0.0f,
      -3.0862664687972017f,
      -1.1721513422464978f,
      0.0f,
      0.0f,
      -1.1721513422464978f,
      -3.0862664687972017f,
      0.0f,
      -1.0f,
      -2.22474487139f,
      2.22474487139f,
      0.0f,
      1.0f,
      -2.22474487139f,
      2.22474487139f,
      0.0f,
      0.0f,
      -1.1721513422464978f,
      3.0862664687972017f,
      0.0f,
      0.0f,
      -3.0862664687972017f,
      1.1721513422464978f,
      0.0f,
      //--------------------------------------------------------------------//
      -2.22474487139f,
      -2.22474487139f,
      -1.0f,
      0.0f,
      -2.22474487139f,
      -2.22474487139f,
      1.0f,
      0.0f,
      -3.0862664687972017f,
      -1.1721513422464978f,
      0.0f,
      0.0f,
      -1.1721513422464978f,
      -3.0862664687972017f,
      0.0f,
      0.0f,
      -2.22474487139f,
      -1.0f,
      -2.22474487139f,
      0.0f,
      -2.22474487139f,
      1.0f,
      -2.22474487139f,
      0.0f,
      -1.1721513422464978f,
      0.0f,
      -3.0862664687972017f,
      0.0f,
      -3.0862664687972017f,
      0.0f,
      -1.1721513422464978f,
      0.0f,
      -2.22474487139f,
      -1.0f,
      2.22474487139f,
      0.0f,
      -2.22474487139f,
      1.0f,
      2.22474487139f,
      0.0f,
      -3.0862664687972017f,
      0.0f,
      1.1721513422464978f,
      0.0f,
      -1.1721513422464978f,
      0.0f,
      3.0862664687972017f,
      0.0f,
      -1.0f,
      2.22474487139f,
      -2.22474487139f,
      0.0f,
      1.0f,
      2.22474487139f,
      -2.22474487139f,
      0.0f,
      0.0f,
      1.1721513422464978f,
      -3.0862664687972017f,
      0.0f,
      0.0f,
      3.0862664687972017f,
      -1.1721513422464978f,
      0.0f,
      -1.0f,
      2.22474487139f,
      2.22474487139f,
      0.0f,
      1.0f,
      2.22474487139f,
      2.22474487139f,
      0.0f,
      0.0f,
      3.0862664687972017f,
      1.1721513422464978f,
      0.0f,
      0.0f,
      1.1721513422464978f,
      3.0862664687972017f,
      0.0f,
      2.22474487139f,
      -2.22474487139f,
      -1.0f,
      0.0f,
      2.22474487139f,
      -2.22474487139f,
      1.0f,
      0.0f,
      1.1721513422464978f,
      -3.0862664687972017f,
      0.0f,
      0.0f,
      3.0862664687972017f,
      -1.1721513422464978f,
      0.0f,
      0.0f,
      2.22474487139f,
      -1.0f,
      -2.22474487139f,
      0.0f,
      2.22474487139f,
      1.0f,
      -2.22474487139f,
      0.0f,
      3.0862664687972017f,
      0.0f,
      -1.1721513422464978f,
      0.0f,
      1.1721513422464978f,
      0.0f,
      -3.0862664687972017f,
      0.0f,
      2.22474487139f,
      -1.0f,
      2.22474487139f,
      0.0f,
      2.22474487139f,
      1.0f,
      2.22474487139f,
      0.0f,
      1.1721513422464978f,
      0.0f,
      3.0862664687972017f,
      0.0f,
      3.0862664687972017f,
      0.0f,
      1.1721513422464978f,
      0.0f,
  };
  for (size_t i = 0; i < (sizeof(grad3) / sizeof(float)); ++i) {
    grad3[i] = (float)(grad3[i] / NORMALIZER_3D);
  }
  for (size_t i = 0, j = 0; i < (sizeof(GRADIENTS_3D) / sizeof(float));
       ++i, ++j) {
    if (j == (sizeof(grad3) / sizeof(float)))
      j = 0;
    GRADIENTS_3D[i] = grad3[i];
  }

  float grad4[] = {
      -0.6740059517812944f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.7504883828755602f,
      0.15296486218853164f,
      -0.4004672082940195f,
      0.5029860367700724f,
      -0.8828161875373585f,
      0.08164729285680945f,
      0.08164729285680945f,
      0.4553054119602712f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.5029860367700724f,
      0.4004672082940195f,
      -0.15296486218853164f,
      0.7504883828755602f,
      -0.5794684678643381f,
      0.3239847771997537f,
      0.3239847771997537f,
      0.6740059517812944f,
      -0.6740059517812944f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.4004672082940195f,
      -0.8828161875373585f,
      0.08164729285680945f,
      0.4553054119602712f,
      0.08164729285680945f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.15296486218853164f,
      -0.5794684678643381f,
      0.3239847771997537f,
      0.6740059517812944f,
      0.3239847771997537f,
      -0.6740059517812944f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      -0.7504883828755602f,
      0.5029860367700724f,
      -0.4004672082940195f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.4004672082940195f,
      -0.8828161875373585f,
      0.4553054119602712f,
      0.08164729285680945f,
      0.08164729285680945f,
      -0.4553054119602712f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      -0.5029860367700724f,
      0.7504883828755602f,
      -0.15296486218853164f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.15296486218853164f,
      -0.5794684678643381f,
      0.6740059517812944f,
      0.3239847771997537f,
      0.3239847771997537f,
      0.5794684678643381f,
      -0.6740059517812944f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      0.5029860367700724f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.7504883828755602f,
      0.15296486218853164f,
      -0.4004672082940195f,
      0.4553054119602712f,
      -0.8828161875373585f,
      0.08164729285680945f,
      0.08164729285680945f,
      0.8828161875373585f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      0.7504883828755602f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.5029860367700724f,
      0.4004672082940195f,
      -0.15296486218853164f,
      0.6740059517812944f,
      -0.5794684678643381f,
      0.3239847771997537f,
      0.3239847771997537f,
      //------------------------------------------------------------------------------------------//
      -0.753341017856078f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      -0.8586508742123365f,
      -0.508629699630796f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      -0.508629699630796f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.508629699630796f,
      -0.9982828964265062f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.37968289875261624f,
      -0.753341017856078f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      0.12128480194602098f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      -0.508629699630796f,
      -0.8586508742123365f,
      0.044802370851755174f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.8586508742123365f,
      -0.508629699630796f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      -0.508629699630796f,
      -0.03381941603233842f,
      -0.9982828964265062f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.753341017856078f,
      -0.37968289875261624f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      0.12128480194602098f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      -0.508629699630796f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.508629699630796f,
      -0.8586508742123365f,
      0.044802370851755174f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.8586508742123365f,
      -0.508629699630796f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.9982828964265062f,
      -0.03381941603233842f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.37968289875261624f,
      -0.753341017856078f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.7821684431180708f,
      -0.4321472685365301f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      0.12128480194602098f,
      -0.4321472685365301f,
      -0.4321472685365301f,
      -0.7821684431180708f,
      -0.508629699630796f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      -0.508629699630796f,
      0.044802370851755174f,
      -0.8586508742123365f,
      0.044802370851755174f,
      0.044802370851755174f,
      -0.508629699630796f,
      -0.8586508742123365f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.03381941603233842f,
      -0.9982828964265062f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.15296486218853164f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.5029860367700724f,
      0.08164729285680945f,
      -0.8828161875373585f,
      0.08164729285680945f,
      0.4553054119602712f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.4004672082940195f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.7504883828755602f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.3239847771997537f,
      0.6740059517812944f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      0.5794684678643381f,
      -0.4004672082940195f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.5029860367700724f,
      0.08164729285680945f,
      0.08164729285680945f,
      -0.8828161875373585f,
      0.4553054119602712f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      0.8828161875373585f,
      -0.15296486218853164f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.7504883828755602f,
      0.3239847771997537f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.6740059517812944f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.5029860367700724f,
      0.15296486218853164f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.5029860367700724f,
      -0.4004672082940195f,
      0.08164729285680945f,
      -0.8828161875373585f,
      0.4553054119602712f,
      0.08164729285680945f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.7504883828755602f,
      0.4004672082940195f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.7504883828755602f,
      -0.15296486218853164f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.6740059517812944f,
      0.3239847771997537f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.6740059517812944f,
      -0.4004672082940195f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.7504883828755602f,
      0.15296486218853164f,
      -0.4004672082940195f,
      0.5029860367700724f,
      -0.7504883828755602f,
      0.08164729285680945f,
      0.08164729285680945f,
      0.4553054119602712f,
      -0.8828161875373585f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.4553054119602712f,
      -0.15296486218853164f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.5029860367700724f,
      0.4004672082940195f,
      -0.15296486218853164f,
      0.7504883828755602f,
      -0.5029860367700724f,
      0.3239847771997537f,
      0.3239847771997537f,
      0.6740059517812944f,
      -0.5794684678643381f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.6740059517812944f,
      -0.3239847771997537f,
      -0.4004672082940195f,
      0.5029860367700724f,
      -0.7504883828755602f,
      0.15296486218853164f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.08164729285680945f,
      0.4553054119602712f,
      -0.8828161875373585f,
      0.08164729285680945f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      -0.15296486218853164f,
      0.7504883828755602f,
      -0.5029860367700724f,
      0.4004672082940195f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.3239847771997537f,
      0.6740059517812944f,
      -0.5794684678643381f,
      0.3239847771997537f,
      -0.3239847771997537f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      -0.4004672082940195f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.15296486218853164f,
      0.5029860367700724f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.08164729285680945f,
      0.4553054119602712f,
      0.08164729285680945f,
      -0.8828161875373585f,
      -0.08164729285680945f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      -0.15296486218853164f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.4004672082940195f,
      0.7504883828755602f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.3239847771997537f,
      0.6740059517812944f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      -0.3239847771997537f,
      0.5029860367700724f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.15296486218853164f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.7504883828755602f,
      -0.4004672082940195f,
      0.4553054119602712f,
      0.08164729285680945f,
      -0.8828161875373585f,
      0.08164729285680945f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      -0.08164729285680945f,
      0.7504883828755602f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.4004672082940195f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.5029860367700724f,
      -0.15296486218853164f,
      0.6740059517812944f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.3239847771997537f,
      0.5794684678643381f,
      -0.3239847771997537f,
      -0.3239847771997537f,
      -0.6740059517812944f,
      0.5029860367700724f,
      -0.4004672082940195f,
      0.15296486218853164f,
      -0.7504883828755602f,
      0.5029860367700724f,
      0.15296486218853164f,
      -0.4004672082940195f,
      -0.7504883828755602f,
      0.4553054119602712f,
      0.08164729285680945f,
      0.08164729285680945f,
      -0.8828161875373585f,
      0.8828161875373585f,
      -0.08164729285680945f,
      -0.08164729285680945f,
      -0.4553054119602712f,
      0.7504883828755602f,
      -0.15296486218853164f,
      0.4004672082940195f,
      -0.5029860367700724f,
      0.7504883828755602f,
      0.4004672082940195f,
      -0.15296486218853164f,
      -0.5029860367700724f,
      0.6740059517812944f,
      0.3239847771997537f,
      0.3239847771997537f,
      -0.5794684678643381f,
      0.03381941603233842f,
      0.03381941603233842f,
      0.03381941603233842f,
      0.9982828964265062f,
      -0.044802370851755174f,
      -0.044802370851755174f,
      0.508629699630796f,
      0.8586508742123365f,
      -0.044802370851755174f,
      0.508629699630796f,
      -0.044802370851755174f,
      0.8586508742123365f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.7821684431180708f,
      0.508629699630796f,
      -0.044802370851755174f,
      -0.044802370851755174f,
      0.8586508742123365f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.7821684431180708f,
      0.4321472685365301f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.7821684431180708f,
      0.37968289875261624f,
      0.37968289875261624f,
      0.37968289875261624f,
      0.753341017856078f,
      0.03381941603233842f,
      0.03381941603233842f,
      0.9982828964265062f,
      0.03381941603233842f,
      -0.044802370851755174f,
      0.044802370851755174f,
      0.8586508742123365f,
      0.508629699630796f,
      -0.044802370851755174f,
      0.508629699630796f,
      0.8586508742123365f,
      -0.044802370851755174f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.7821684431180708f,
      0.4321472685365301f,
      0.508629699630796f,
      -0.044802370851755174f,
      0.8586508742123365f,
      -0.044802370851755174f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.7821684431180708f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.7821684431180708f,
      -0.12128480194602098f,
      0.37968289875261624f,
      0.37968289875261624f,
      0.753341017856078f,
      0.37968289875261624f,
      0.03381941603233842f,
      0.9982828964265062f,
      0.03381941603233842f,
      0.03381941603233842f,
      -0.044802370851755174f,
      0.8586508742123365f,
      -0.044802370851755174f,
      0.508629699630796f,
      -0.044802370851755174f,
      0.8586508742123365f,
      0.508629699630796f,
      -0.044802370851755174f,
      -0.12128480194602098f,
      0.7821684431180708f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.508629699630796f,
      0.8586508742123365f,
      -0.044802370851755174f,
      -0.044802370851755174f,
      0.4321472685365301f,
      0.7821684431180708f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.7821684431180708f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.37968289875261624f,
      0.753341017856078f,
      0.37968289875261624f,
      0.37968289875261624f,
      0.9982828964265062f,
      0.03381941603233842f,
      0.03381941603233842f,
      0.03381941603233842f,
      0.8586508742123365f,
      -0.044802370851755174f,
      -0.044802370851755174f,
      0.508629699630796f,
      0.8586508742123365f,
      -0.044802370851755174f,
      0.508629699630796f,
      -0.044802370851755174f,
      0.7821684431180708f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.4321472685365301f,
      0.8586508742123365f,
      0.508629699630796f,
      -0.044802370851755174f,
      -0.044802370851755174f,
      0.7821684431180708f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.4321472685365301f,
      0.7821684431180708f,
      0.4321472685365301f,
      0.4321472685365301f,
      -0.12128480194602098f,
      0.753341017856078f,
      0.37968289875261624f,
      0.37968289875261624f,
      0.37968289875261624f,
  };
  for (size_t i = 0; i < (sizeof(grad4) / sizeof(float)); ++i) {
    grad4[i] = (float)(grad4[i] / NORMALIZER_4D);
  }
  for (size_t i = 0, j = 0; i < (sizeof(GRADIENTS_4D) / sizeof(float));
       ++i, ++j) {
    if (j == (sizeof(grad4) / sizeof(float)))
      j = 0;
    GRADIENTS_4D[i] = grad4[i];
  }

  int r1
      [] = {0x15, 0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
            0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r2[] = {0x15, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65,
            0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
    r3[] = {0x01, 0x05, 0x11, 0x15, 0x41, 0x45, 0x51, 0x55,
            0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA},
    r4[] = {0x01, 0x15, 0x16, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56,
            0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r5[] = {0x15, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65,
            0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
    r6[] = {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x65,
            0x66, 0x69, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
    r7[] = {0x05, 0x15, 0x45, 0x55, 0x56, 0x59,
            0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xAA},
    r8[] = {0x05, 0x15, 0x16, 0x45, 0x46, 0x55, 0x56, 0x59,
            0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xAA, 0xAB},
    r9[] = {0x04, 0x05, 0x14, 0x15, 0x44, 0x45, 0x54, 0x55,
            0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA},
    r10[] = {0x05, 0x15, 0x45, 0x55, 0x56, 0x59,
             0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xAA},
    r11[] = {0x05, 0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x9A, 0xAA},
    r12[] = {0x05, 0x15, 0x16, 0x45, 0x46, 0x55, 0x56,
             0x59, 0x5A, 0x5B, 0x6A, 0x9A, 0xAA, 0xAB},
    r13[] = {0x04, 0x15, 0x19, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59,
             0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r14[] = {0x05, 0x15, 0x19, 0x45, 0x49, 0x55, 0x56, 0x59,
             0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xAA, 0xAE},
    r15[] = {0x05, 0x15, 0x19, 0x45, 0x49, 0x55, 0x56,
             0x59, 0x5A, 0x5E, 0x6A, 0x9A, 0xAA, 0xAE},
    r16[] = {0x05, 0x15, 0x1A, 0x45, 0x4A, 0x55, 0x56, 0x59, 0x5A,
             0x5B, 0x5E, 0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r17[] = {0x15, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66,
             0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
    r18[] = {0x11, 0x15, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x69, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
    r19[] = {0x11, 0x15, 0x51, 0x55, 0x56, 0x5A,
             0x65, 0x66, 0x6A, 0x96, 0xA6, 0xAA},
    r20[] = {0x11, 0x15, 0x16, 0x51, 0x52, 0x55, 0x56, 0x5A,
             0x65, 0x66, 0x6A, 0x96, 0xA6, 0xAA, 0xAB},
    r21[] = {0x14, 0x15, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
    r22[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
             0x69, 0x6A, 0x95, 0x9A, 0xA6, 0xA9, 0xAA},
    r23[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
             0x69, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r24[] = {0x15, 0x16, 0x55, 0x56, 0x5A, 0x66, 0x6A,
             0x6B, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r25[] = {0x14, 0x15, 0x54, 0x55, 0x59, 0x5A,
             0x65, 0x69, 0x6A, 0x99, 0xA9, 0xAA},
    r26[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
             0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r27[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x9A, 0xAA},
    r28[] = {0x15, 0x16, 0x55, 0x56, 0x59, 0x5A,
             0x66, 0x6A, 0x6B, 0x9A, 0xAA, 0xAB},
    r29[] = {0x14, 0x15, 0x19, 0x54, 0x55, 0x58, 0x59, 0x5A,
             0x65, 0x69, 0x6A, 0x99, 0xA9, 0xAA, 0xAE},
    r30[] = {0x15, 0x19, 0x55, 0x59, 0x5A, 0x69, 0x6A,
             0x6E, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r31[] = {0x15, 0x19, 0x55, 0x56, 0x59, 0x5A,
             0x69, 0x6A, 0x6E, 0x9A, 0xAA, 0xAE},
    r32[] = {0x15, 0x1A, 0x55, 0x56, 0x59, 0x5A, 0x6A,
             0x6B, 0x6E, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r33[] = {0x10, 0x11, 0x14, 0x15, 0x50, 0x51, 0x54, 0x55,
             0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA},
    r34[] = {0x11, 0x15, 0x51, 0x55, 0x56, 0x65,
             0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xAA},
    r35[] = {0x11, 0x15, 0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0xA6, 0xAA},
    r36[] = {0x11, 0x15, 0x16, 0x51, 0x52, 0x55, 0x56,
             0x65, 0x66, 0x67, 0x6A, 0xA6, 0xAA, 0xAB},
    r37[] = {0x14, 0x15, 0x54, 0x55, 0x59, 0x65,
             0x66, 0x69, 0x6A, 0xA5, 0xA9, 0xAA},
    r38[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
             0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r39[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA6, 0xAA},
    r40[] = {0x15, 0x16, 0x55, 0x56, 0x5A, 0x65,
             0x66, 0x6A, 0x6B, 0xA6, 0xAA, 0xAB},
    r41[] = {0x14, 0x15, 0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0xA9, 0xAA},
    r42[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xA9, 0xAA},
    r43[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0xAA},
    r44[] = {0x15, 0x16, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x69, 0x6A, 0x6B, 0xAA, 0xAB},
    r45[] = {0x14, 0x15, 0x19, 0x54, 0x55, 0x58, 0x59,
             0x65, 0x69, 0x6A, 0x6D, 0xA9, 0xAA, 0xAE},
    r46[] = {0x15, 0x19, 0x55, 0x59, 0x5A, 0x65,
             0x69, 0x6A, 0x6E, 0xA9, 0xAA, 0xAE},
    r47[] = {0x15, 0x19, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x69, 0x6A, 0x6E, 0xAA, 0xAE},
    r48[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x69, 0x6A,
             0x6B, 0x6E, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r49[] = {0x10, 0x15, 0x25, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65,
             0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r50[] = {0x11, 0x15, 0x25, 0x51, 0x55, 0x56, 0x61, 0x65,
             0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xAA, 0xBA},
    r51[] = {0x11, 0x15, 0x25, 0x51, 0x55, 0x56, 0x61,
             0x65, 0x66, 0x6A, 0x76, 0xA6, 0xAA, 0xBA},
    r52[] = {0x11, 0x15, 0x26, 0x51, 0x55, 0x56, 0x62, 0x65, 0x66,
             0x67, 0x6A, 0x76, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r53[] = {0x14, 0x15, 0x25, 0x54, 0x55, 0x59, 0x64, 0x65,
             0x66, 0x69, 0x6A, 0xA5, 0xA9, 0xAA, 0xBA},
    r54[] = {0x15, 0x25, 0x55, 0x65, 0x66, 0x69, 0x6A,
             0x7A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r55[] = {0x15, 0x25, 0x55, 0x56, 0x65, 0x66,
             0x69, 0x6A, 0x7A, 0xA6, 0xAA, 0xBA},
    r56[] = {0x15, 0x26, 0x55, 0x56, 0x65, 0x66, 0x6A,
             0x6B, 0x7A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r57[] = {0x14, 0x15, 0x25, 0x54, 0x55, 0x59, 0x64,
             0x65, 0x69, 0x6A, 0x79, 0xA9, 0xAA, 0xBA},
    r58[] = {0x15, 0x25, 0x55, 0x59, 0x65, 0x66,
             0x69, 0x6A, 0x7A, 0xA9, 0xAA, 0xBA},
    r59[] = {0x15, 0x25, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x69, 0x6A, 0x7A, 0xAA, 0xBA},
    r60[] = {0x15, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x69, 0x6A,
             0x6B, 0x7A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r61[] = {0x14, 0x15, 0x29, 0x54, 0x55, 0x59, 0x65, 0x68, 0x69,
             0x6A, 0x6D, 0x79, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r62[] = {0x15, 0x29, 0x55, 0x59, 0x65, 0x69, 0x6A,
             0x6E, 0x7A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r63[] = {0x15, 0x55, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
             0x6E, 0x7A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r64[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
             0x6B, 0x6E, 0x7A, 0xAA, 0xAB, 0xAE, 0xBA, 0xBF},
    r65[] = {0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x95,
             0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r66[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA},
    r67[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x5A,
             0x66, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
    r68[] = {0x41, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56, 0x5A,
             0x66, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r69[] = {0x44, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x69, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
    r70[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x6A,
             0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA},
    r71[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A,
             0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xAB},
    r72[] = {0x45, 0x46, 0x55, 0x56, 0x5A, 0x66, 0x6A,
             0x96, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB},
    r73[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x5A,
             0x69, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
    r74[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A,
             0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r75[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
    r76[] = {0x45, 0x46, 0x55, 0x56, 0x59, 0x5A,
             0x6A, 0x96, 0x9A, 0x9B, 0xAA, 0xAB},
    r77[] = {0x44, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59, 0x5A,
             0x69, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r78[] = {0x45, 0x49, 0x55, 0x59, 0x5A, 0x69, 0x6A,
             0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE},
    r79[] = {0x45, 0x49, 0x55, 0x56, 0x59, 0x5A,
             0x6A, 0x99, 0x9A, 0x9E, 0xAA, 0xAE},
    r80[] = {0x45, 0x4A, 0x55, 0x56, 0x59, 0x5A, 0x6A,
             0x9A, 0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xAF},
    r81[] = {0x50, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66,
             0x69, 0x95, 0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
    r82[] = {0x51, 0x55, 0x56, 0x59, 0x65, 0x66, 0x6A,
             0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r83[] = {0x51, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A,
             0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xAB},
    r84[] = {0x51, 0x52, 0x55, 0x56, 0x5A, 0x66, 0x6A,
             0x96, 0x9A, 0xA6, 0xA7, 0xAA, 0xAB},
    r85[] = {0x54, 0x55, 0x56, 0x59, 0x65, 0x69, 0x6A,
             0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r86[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
             0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r87[] = {0x15, 0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r88[] = {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r89[] = {0x54, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A,
             0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAE},
    r90[] = {0x15, 0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65,
             0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r91[] = {0x15, 0x45, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
             0x95, 0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE},
    r92[] = {0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r93[] = {0x54, 0x55, 0x58, 0x59, 0x5A, 0x69, 0x6A,
             0x99, 0x9A, 0xA9, 0xAA, 0xAD, 0xAE},
    r94[] = {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r95[] = {0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r96[] = {0x55, 0x56, 0x59, 0x5A, 0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r97[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x66,
             0x69, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
    r98[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A,
             0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r99[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
    r100[] = {0x51, 0x52, 0x55, 0x56, 0x65, 0x66,
              0x6A, 0x96, 0xA6, 0xA7, 0xAA, 0xAB},
    r101[] = {0x54, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r102[] = {0x15, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66,
              0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r103[] = {0x15, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA},
    r104[] = {0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r105[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
    r106[] = {0x15, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA},
    r107[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
              0x69, 0x6A, 0x9A, 0xA6, 0xA9, 0xAA},
    r108[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
              0x69, 0x6A, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r109[] = {0x54, 0x55, 0x58, 0x59, 0x65, 0x69,
              0x6A, 0x99, 0xA9, 0xAA, 0xAD, 0xAE},
    r110[] = {0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r111[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
              0x69, 0x6A, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r112[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x69,
              0x6A, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r113[] = {0x50, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65, 0x66,
              0x69, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r114[] = {0x51, 0x55, 0x61, 0x65, 0x66, 0x69, 0x6A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA},
    r115[] = {0x51, 0x55, 0x56, 0x61, 0x65, 0x66,
              0x6A, 0xA5, 0xA6, 0xAA, 0xB6, 0xBA},
    r116[] = {0x51, 0x55, 0x56, 0x62, 0x65, 0x66, 0x6A,
              0xA6, 0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xBB},
    r117[] = {0x54, 0x55, 0x64, 0x65, 0x66, 0x69, 0x6A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA},
    r118[] = {0x55, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r119[] = {0x55, 0x56, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r120[] = {0x55, 0x56, 0x65, 0x66, 0x6A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r121[] = {0x54, 0x55, 0x59, 0x64, 0x65, 0x69,
              0x6A, 0xA5, 0xA9, 0xAA, 0xB9, 0xBA},
    r122[] = {0x55, 0x59, 0x65, 0x66, 0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r123[] = {0x15, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66,
              0x69, 0x6A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r124[] = {0x15, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x69,
              0x6A, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r125[] = {0x54, 0x55, 0x59, 0x65, 0x68, 0x69, 0x6A,
              0xA9, 0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xBE},
    r126[] = {0x55, 0x59, 0x65, 0x69, 0x6A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r127[] = {0x15, 0x55, 0x59, 0x5A, 0x65, 0x66, 0x69,
              0x6A, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r128[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69,
              0x6A, 0xAA, 0xAB, 0xAE, 0xBA, 0xBF},
    r129[] = {0x40, 0x41, 0x44, 0x45, 0x50, 0x51, 0x54, 0x55,
              0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r130[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA},
    r131[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x95, 0x96, 0x9A, 0xA6, 0xAA},
    r132[] = {0x41, 0x45, 0x46, 0x51, 0x52, 0x55, 0x56,
              0x95, 0x96, 0x97, 0x9A, 0xA6, 0xAA, 0xAB},
    r133[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
    r134[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r135[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA},
    r136[] = {0x45, 0x46, 0x55, 0x56, 0x5A, 0x95,
              0x96, 0x9A, 0x9B, 0xA6, 0xAA, 0xAB},
    r137[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x95, 0x99, 0x9A, 0xA9, 0xAA},
    r138[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA},
    r139[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A, 0xAA},
    r140[] = {0x45, 0x46, 0x55, 0x56, 0x59, 0x5A, 0x95,
              0x96, 0x99, 0x9A, 0x9B, 0xAA, 0xAB},
    r141[] = {0x44, 0x45, 0x49, 0x54, 0x55, 0x58, 0x59,
              0x95, 0x99, 0x9A, 0x9D, 0xA9, 0xAA, 0xAE},
    r142[] = {0x45, 0x49, 0x55, 0x59, 0x5A, 0x95,
              0x99, 0x9A, 0x9E, 0xA9, 0xAA, 0xAE},
    r143[] = {0x45, 0x49, 0x55, 0x56, 0x59, 0x5A, 0x95,
              0x96, 0x99, 0x9A, 0x9E, 0xAA, 0xAE},
    r144[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x96, 0x99,
              0x9A, 0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xAF},
    r145[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x95,
              0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
    r146[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r147[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA},
    r148[] = {0x51, 0x52, 0x55, 0x56, 0x66, 0x95,
              0x96, 0x9A, 0xA6, 0xA7, 0xAA, 0xAB},
    r149[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r150[] = {0x45, 0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r151[] = {0x45, 0x51, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xEA},
    r152[] = {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB},
    r153[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA},
    r154[] = {0x45, 0x54, 0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xEA},
    r155[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95,
              0x96, 0x99, 0x9A, 0xA6, 0xA9, 0xAA},
    r156[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x66, 0x6A,
              0x95, 0x96, 0x99, 0x9A, 0xA6, 0xAA, 0xAB},
    r157[] = {0x54, 0x55, 0x58, 0x59, 0x69, 0x95,
              0x99, 0x9A, 0xA9, 0xAA, 0xAD, 0xAE},
    r158[] = {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r159[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x69, 0x6A,
              0x95, 0x96, 0x99, 0x9A, 0xA9, 0xAA, 0xAE},
    r160[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x6A, 0x96,
              0x99, 0x9A, 0xAA, 0xAB, 0xAE, 0xAF},
    r161[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x95, 0xA5, 0xA6, 0xA9, 0xAA},
    r162[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA},
    r163[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6, 0xAA},
    r164[] = {0x51, 0x52, 0x55, 0x56, 0x65, 0x66, 0x95,
              0x96, 0xA5, 0xA6, 0xA7, 0xAA, 0xAB},
    r165[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA},
    r166[] = {0x51, 0x54, 0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA},
    r167[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x95,
              0x96, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r168[] = {0x51, 0x55, 0x56, 0x5A, 0x65, 0x66, 0x6A,
              0x95, 0x96, 0x9A, 0xA5, 0xA6, 0xAA, 0xAB},
    r169[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9, 0xAA},
    r170[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x95,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r171[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA},
    r172[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x6A,
              0x95, 0x96, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB},
    r173[] = {0x54, 0x55, 0x58, 0x59, 0x65, 0x69, 0x95,
              0x99, 0xA5, 0xA9, 0xAA, 0xAD, 0xAE},
    r174[] = {0x54, 0x55, 0x59, 0x5A, 0x65, 0x69, 0x6A,
              0x95, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xAE},
    r175[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x69, 0x6A,
              0x95, 0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAE},
    r176[] = {0x55, 0x56, 0x59, 0x5A, 0x66, 0x69, 0x6A, 0x96,
              0x99, 0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xAF},
    r177[] = {0x50, 0x51, 0x54, 0x55, 0x61, 0x64, 0x65,
              0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xB5, 0xBA},
    r178[] = {0x51, 0x55, 0x61, 0x65, 0x66, 0x95,
              0xA5, 0xA6, 0xA9, 0xAA, 0xB6, 0xBA},
    r179[] = {0x51, 0x55, 0x56, 0x61, 0x65, 0x66, 0x95,
              0x96, 0xA5, 0xA6, 0xAA, 0xB6, 0xBA},
    r180[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x96, 0xA5,
              0xA6, 0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xBB},
    r181[] = {0x54, 0x55, 0x64, 0x65, 0x69, 0x95,
              0xA5, 0xA6, 0xA9, 0xAA, 0xB9, 0xBA},
    r182[] = {0x55, 0x65, 0x66, 0x69, 0x6A, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r183[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x96, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r184[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x6A, 0x96,
              0xA5, 0xA6, 0xAA, 0xAB, 0xBA, 0xBB},
    r185[] = {0x54, 0x55, 0x59, 0x64, 0x65, 0x69, 0x95,
              0x99, 0xA5, 0xA9, 0xAA, 0xB9, 0xBA},
    r186[] = {0x54, 0x55, 0x59, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r187[] = {0x55, 0x56, 0x59, 0x65, 0x66, 0x69, 0x6A,
              0x95, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA},
    r188[] = {0x55, 0x56, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x96,
              0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA, 0xBB},
    r189[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x99, 0xA5,
              0xA9, 0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xBE},
    r190[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x6A, 0x99,
              0xA5, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r191[] = {0x55, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x99,
              0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA, 0xBE},
    r192[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A,
              0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xBA},
    r193[] = {0x40, 0x45, 0x51, 0x54, 0x55, 0x85, 0x91, 0x94, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r194[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x85, 0x91, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xAA, 0xEA},
    r195[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x85, 0x91,
              0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xD6, 0xEA},
    r196[] = {0x41, 0x45, 0x51, 0x55, 0x56, 0x86, 0x92, 0x95, 0x96,
              0x97, 0x9A, 0xA6, 0xAA, 0xAB, 0xD6, 0xEA, 0xEB},
    r197[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x85, 0x94, 0x95,
              0x96, 0x99, 0x9A, 0xA5, 0xA9, 0xAA, 0xEA},
    r198[] = {0x45, 0x55, 0x85, 0x95, 0x96, 0x99, 0x9A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xDA, 0xEA},
    r199[] = {0x45, 0x55, 0x56, 0x85, 0x95, 0x96,
              0x99, 0x9A, 0xA6, 0xAA, 0xDA, 0xEA},
    r200[] = {0x45, 0x55, 0x56, 0x86, 0x95, 0x96, 0x9A,
              0x9B, 0xA6, 0xAA, 0xAB, 0xDA, 0xEA, 0xEB},
    r201[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x85, 0x94,
              0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xD9, 0xEA},
    r202[] = {0x45, 0x55, 0x59, 0x85, 0x95, 0x96,
              0x99, 0x9A, 0xA9, 0xAA, 0xDA, 0xEA},
    r203[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x85, 0x95,
              0x96, 0x99, 0x9A, 0xAA, 0xDA, 0xEA},
    r204[] = {0x45, 0x55, 0x56, 0x5A, 0x95, 0x96, 0x99, 0x9A,
              0x9B, 0xA6, 0xAA, 0xAB, 0xDA, 0xEA, 0xEB},
    r205[] = {0x44, 0x45, 0x54, 0x55, 0x59, 0x89, 0x95, 0x98, 0x99,
              0x9A, 0x9D, 0xA9, 0xAA, 0xAE, 0xD9, 0xEA, 0xEE},
    r206[] = {0x45, 0x55, 0x59, 0x89, 0x95, 0x99, 0x9A,
              0x9E, 0xA9, 0xAA, 0xAE, 0xDA, 0xEA, 0xEE},
    r207[] = {0x45, 0x55, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A,
              0x9E, 0xA9, 0xAA, 0xAE, 0xDA, 0xEA, 0xEE},
    r208[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99, 0x9A,
              0x9B, 0x9E, 0xAA, 0xAB, 0xAE, 0xDA, 0xEA, 0xEF},
    r209[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x91, 0x94, 0x95,
              0x96, 0x99, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r210[] = {0x51, 0x55, 0x91, 0x95, 0x96, 0x99, 0x9A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xE6, 0xEA},
    r211[] = {0x51, 0x55, 0x56, 0x91, 0x95, 0x96,
              0x9A, 0xA5, 0xA6, 0xAA, 0xE6, 0xEA},
    r212[] = {0x51, 0x55, 0x56, 0x92, 0x95, 0x96, 0x9A,
              0xA6, 0xA7, 0xAA, 0xAB, 0xE6, 0xEA, 0xEB},
    r213[] = {0x54, 0x55, 0x94, 0x95, 0x96, 0x99, 0x9A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xE9, 0xEA},
    r214[] = {0x55, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r215[] = {0x55, 0x56, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r216[] = {0x55, 0x56, 0x95, 0x96, 0x9A, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
    r217[] = {0x54, 0x55, 0x59, 0x94, 0x95, 0x99,
              0x9A, 0xA5, 0xA9, 0xAA, 0xE9, 0xEA},
    r218[] = {0x55, 0x59, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r219[] = {0x45, 0x55, 0x56, 0x59, 0x5A, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r220[] = {0x45, 0x55, 0x56, 0x5A, 0x95, 0x96, 0x99,
              0x9A, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
    r221[] = {0x54, 0x55, 0x59, 0x95, 0x98, 0x99, 0x9A,
              0xA9, 0xAA, 0xAD, 0xAE, 0xE9, 0xEA, 0xEE},
    r222[] = {0x55, 0x59, 0x95, 0x99, 0x9A, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
    r223[] = {0x45, 0x55, 0x59, 0x5A, 0x95, 0x96, 0x99,
              0x9A, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
    r224[] = {0x55, 0x56, 0x59, 0x5A, 0x95, 0x96, 0x99,
              0x9A, 0xAA, 0xAB, 0xAE, 0xEA, 0xEF},
    r225[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x91, 0x94,
              0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xE5, 0xEA},
    r226[] = {0x51, 0x55, 0x65, 0x91, 0x95, 0x96,
              0xA5, 0xA6, 0xA9, 0xAA, 0xE6, 0xEA},
    r227[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x91, 0x95,
              0x96, 0xA5, 0xA6, 0xAA, 0xE6, 0xEA},
    r228[] = {0x51, 0x55, 0x56, 0x66, 0x95, 0x96, 0x9A, 0xA5,
              0xA6, 0xA7, 0xAA, 0xAB, 0xE6, 0xEA, 0xEB},
    r229[] = {0x54, 0x55, 0x65, 0x94, 0x95, 0x99,
              0xA5, 0xA6, 0xA9, 0xAA, 0xE9, 0xEA},
    r230[] = {0x55, 0x65, 0x95, 0x96, 0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r231[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r232[] = {0x51, 0x55, 0x56, 0x66, 0x95, 0x96, 0x9A,
              0xA5, 0xA6, 0xAA, 0xAB, 0xEA, 0xEB},
    r233[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x94, 0x95,
              0x99, 0xA5, 0xA9, 0xAA, 0xE9, 0xEA},
    r234[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r235[] = {0x55, 0x56, 0x59, 0x65, 0x6A, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xEA},
    r236[] = {0x55, 0x56, 0x5A, 0x66, 0x6A, 0x95, 0x96, 0x99,
              0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xEA, 0xEB},
    r237[] = {0x54, 0x55, 0x59, 0x69, 0x95, 0x99, 0x9A, 0xA5,
              0xA9, 0xAA, 0xAD, 0xAE, 0xE9, 0xEA, 0xEE},
    r238[] = {0x54, 0x55, 0x59, 0x69, 0x95, 0x99, 0x9A,
              0xA5, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
    r239[] = {0x55, 0x59, 0x5A, 0x69, 0x6A, 0x95, 0x96, 0x99,
              0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xEA, 0xEE},
    r240[] = {0x55, 0x56, 0x59, 0x5A, 0x6A, 0x95, 0x96, 0x99,
              0x9A, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xEA},
    r241[] = {0x50, 0x51, 0x54, 0x55, 0x65, 0x95, 0xA1, 0xA4, 0xA5,
              0xA6, 0xA9, 0xAA, 0xB5, 0xBA, 0xE5, 0xEA, 0xFA},
    r242[] = {0x51, 0x55, 0x65, 0x95, 0xA1, 0xA5, 0xA6,
              0xA9, 0xAA, 0xB6, 0xBA, 0xE6, 0xEA, 0xFA},
    r243[] = {0x51, 0x55, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6,
              0xA9, 0xAA, 0xB6, 0xBA, 0xE6, 0xEA, 0xFA},
    r244[] = {0x51, 0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5, 0xA6,
              0xA7, 0xAA, 0xAB, 0xB6, 0xBA, 0xE6, 0xEA, 0xFB},
    r245[] = {0x54, 0x55, 0x65, 0x95, 0xA4, 0xA5, 0xA6,
              0xA9, 0xAA, 0xB9, 0xBA, 0xE9, 0xEA, 0xFA},
    r246[] = {0x55, 0x65, 0x95, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
    r247[] = {0x51, 0x55, 0x65, 0x66, 0x95, 0x96, 0xA5,
              0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
    r248[] = {0x55, 0x56, 0x65, 0x66, 0x95, 0x96, 0xA5,
              0xA6, 0xAA, 0xAB, 0xBA, 0xEA, 0xFB},
    r249[] = {0x54, 0x55, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA6,
              0xA9, 0xAA, 0xB9, 0xBA, 0xE9, 0xEA, 0xFA},
    r250[] = {0x54, 0x55, 0x65, 0x69, 0x95, 0x99, 0xA5,
              0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
    r251[] = {0x55, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96, 0x99,
              0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xBA, 0xEA, 0xFA},
    r252[] = {0x55, 0x56, 0x65, 0x66, 0x6A, 0x95, 0x96, 0x9A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xBA, 0xEA},
    r253[] = {0x54, 0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5, 0xA9,
              0xAA, 0xAD, 0xAE, 0xB9, 0xBA, 0xE9, 0xEA, 0xFE},
    r254[] = {0x55, 0x59, 0x65, 0x69, 0x95, 0x99, 0xA5,
              0xA9, 0xAA, 0xAE, 0xBA, 0xEA, 0xFE},
    r255[] = {0x55, 0x59, 0x65, 0x69, 0x6A, 0x95, 0x99, 0x9A,
              0xA5, 0xA6, 0xA9, 0xAA, 0xAE, 0xBA, 0xEA},
    r256[] = {0x55, 0x56, 0x59, 0x5A, 0x65, 0x66, 0x69, 0x6A, 0x95, 0x96,
              0x99, 0x9A, 0xA5, 0xA6, 0xA9, 0xAA, 0xAB, 0xAE, 0xBA, 0xEA};
  int *lookup4DVertexCodes[] = {
      r1,   r2,   r3,   r4,   r5,   r6,   r7,   r7,   r8,   r9,   r10,  r11,
      r12,  r13,  r14,  r15,  r16,  r17,  r18,  r19,  r20,  r21,  r22,  r23,
      r24,  r25,  r26,  r27,  r28,  r29,  r30,  r31,  r32,  r33,  r34,  r35,
      r36,  r37,  r38,  r39,  r40,  r41,  r42,  r43,  r44,  r45,  r46,  r47,
      r48,  r49,  r50,  r51,  r52,  r53,  r54,  r55,  r56,  r57,  r58,  r59,
      r60,  r61,  r62,  r63,  r64,  r65,  r66,  r67,  r68,  r69,  r70,  r71,
      r72,  r73,  r74,  r75,  r76,  r77,  r78,  r79,  r80,  r81,  r82,  r83,
      r84,  r85,  r85,  r86,  r87,  r88,  r89,  r90,  r91,  r92,  r93,  r94,
      r95,  r96,  r97,  r98,  r99,  r100, r101, r102, r103, r104, r105, r106,
      r107, r108, r109, r110, r111, r112, r113, r114, r115, r116, r117, r118,
      r119, r120, r121, r122, r123, r124, r125, r126, r127, r128, r129, r130,
      r131, r132, r133, r134, r135, r136, r137, r18,  r139, r140, r141, r142,
      r143, r144, r145, r146, r147, r148, r149, r150, r151, r152, r153, r154,
      r155, r156, r157, r158, r159, r160, r161, r162, r163, r163, r164, r165,
      r166, r167, r168, r168, r169, r170, r171, r172, r173, r174, r175, r176,
      r177, r178, r179, r179, r180, r181, r182, r183, r184, r185, r186, r187,
      r188, r189, r190, r191, r192, r193, r194, r195, r196, r197, r198, r199,
      r200, r201, r202, r203, r204, r205, r206, r207, r208, r209, r210, r211,
      r212, r213, r214, r215, r216, r217, r218, r219, r220, r221, r222, r223,
      r224, r225, r226, r227, r228, r229, r230, r231, r232, r233, r234, r235,
      r236, r237, r238, r239, r240, r241, r242, r243, r244, r245, r246, r247,
      r248, r249, r250, r251, r252, r253, r254, r255, r256};

  LatticeVertex4D latticeVerticiesByCode[256];
  for (int i = 0; i < 256; ++i) {
    int cx = ((i >> 0) & 3) - 1;
    int cy = ((i >> 2) & 3) - 1;
    int cz = ((i >> 4) & 3) - 1;
    int cw = ((i >> 6) & 3) - 1;
    latticeVerticiesByCode[i] = makeLatticeVertex4D(cx, cy, cz, cw);
  }
  size_t nLatticeVerticesTotal = 0;
  for (int i = 0; i < 256; ++i) {
    nLatticeVerticesTotal += (sizeof(&lookup4DVertexCodes[i]) / sizeof(int));
  }
  LOOKUP_4D_B = (LatticeVertex4D *)malloc(sizeof(LatticeVertex4D) *
                                          nLatticeVerticesTotal);
  for (size_t i = 0, j = 0; i < 256; ++i) {
    LOOKUP_4D_A[i] =
        j | ((j + (sizeof(&lookup4DVertexCodes[i]) / sizeof(int))) << 16);
    for (size_t k = 0; k < (sizeof(&lookup4DVertexCodes[i]) / sizeof(int));
         ++k) {
      LOOKUP_4D_B[j++] = latticeVerticiesByCode[lookup4DVertexCodes[i][k]];
    }
  }
}

void opensimple_free() {
  free(LOOKUP_4D_B);
}

static int fastFloor(double x) {
  int xi = (int)x;
  return x < xi ? xi - 1 : xi;
}

static float grad2D(long seed, long xsvp, long ysvp, float dx, float dy) {
  long hash = seed ^ xsvp * ysvp;
  hash *= HASH_MULTIPLIER;
  hash ^= hash >> (64 - N_GRADS_2D_EXPONENT + 1);
  int gi = (int)hash & ((N_GRADS_2D - 1) << 1);
  return GRADIENTS_2D[gi | 0] * dx + GRADIENTS_2D[gi | 1] * dy;
}
static float grad3D(long seed, long xrvp, long yrvp, long zrvp, float dx,
                    float dy, float dz);
static float grad4D(long seed, long xsvp, long ysvp, long zsvp, long wsvp,
                    float dx, float dy, float dz, float dw);

static float noise2_UnskewedBase(long seed, double xs, double ys) {
  int xsb = fastFloor(xs), ysb = fastFloor(ys);
  float xi = (float)(xs - xsb), yi = (float)(ys - ysb);

  long xsbp = xsb * PRIME_X, ysbp = ysb * PRIME_Y;

  float t = (xi + yi) * (float)UNSKEW_2D;
  float dx0 = xi + t, dy0 = yi + t;

  float a0 = RSQUARED_2D - dx0 * dx0 - dy0 * dy0;
  float value = (a0 * a0) * (a0 * a0) * grad2D(seed, xsbp, ysbp, dx0, dy0);

  float a1 = (float)(2 * (1 + 2 * UNSKEW_2D) * (1 / UNSKEW_2D + 2)) * t +
             ((float)(-2 * (1 + 2 * UNSKEW_2D) * (1 + 2 * UNSKEW_2D)) + a0);
  float dx1 = dx0 - (float)(1 + 2 * UNSKEW_2D);
  float dy1 = dy0 - (float)(1 + 2 * UNSKEW_2D);
  value += (a1 * a1) * (a1 * a1) *
           grad2D(seed, xsbp + PRIME_X, ysbp + PRIME_Y, dx1, dy1);

  float xmyi = xi - yi;
  if (t < UNSKEW_2D) {
    if (xi + xmyi > 1) {
      float dx2 = dx0 - (float)(3 * UNSKEW_2D + 2);
      float dy2 = (float)(3 * UNSKEW_2D + 1);
      float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
      if (a2 > 0) {
        value += (a2 * a2) * (a2 * a2) *
                 grad2D(seed, xsbp + (PRIME_X << 1), ysbp + PRIME_Y, dx2, dy2);
      }
    } else {
      float dx2 = dy0 - (float)UNSKEW_2D;
      float dy2 = dy0 - (float)(UNSKEW_2D + 1);
      float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
      if (a2 > 0) {
        value += (a2 * a2) * (a2 * a2) *
                 grad2D(seed, xsbp, ysbp + PRIME_Y, dx2, dy2);
      }
    }

    if (yi - xmyi > 1) {
      float dx3 = dx0 - (float)(3 * UNSKEW_2D + 1);
      float dy3 = dy0 - (float)(3 * UNSKEW_2D + 2);
      float a3 = RSQUARED_2D - dx3 * dx3 - dy3 * dy3;
      if (a3 > 0) {
        value += (a3 * a3) * (a3 * a3) *
                 grad2D(seed, xsbp + PRIME_X, ysbp, dx3, dy3);
      }
    }
  } else {
    if (xi + xmyi < 0) {
      float dx2 = dx0 + (float)(1 + UNSKEW_2D);
      float dy2 = dy0 + (float)UNSKEW_2D;
      float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
      if (a2 > 0) {
        value += (a2 * a2) * (a2 * a2) *
                 grad2D(seed, xsbp - PRIME_X, ysbp, dx2, dy2);
      }
    } else {
      float dx2 = dx0 - (float)(UNSKEW_2D + 1);
      float dy2 = dy0 - (float)UNSKEW_2D;
      float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
      if (a2 > 0) {
        value += (a2 * a2) * (a2 * a2) *
                 grad2D(seed, xsbp + PRIME_X, ysbp, dx2, dy2);
      }
    }

    if (yi < xmyi) {
      float dx2 = dx0 + (float)UNSKEW_2D;
      float dy2 = dy0 + (float)(UNSKEW_2D + 1);
      float a2 = RSQUARED_2D - dx2 * dx2 - dy2 * dy2;
      if (a2 < 0) {
        value += (a2 * a2) * (a2 * a2) *
                 grad2D(seed, xsbp, ysbp + PRIME_Y, dx2, dy2);
      }
    }
  }

  return value;
}

float opensimplex2s_noise2(long seed, double x, double y) {
  double s = SKEW_2D * (x + y);
  double xs = x + s, ys = y + s;

  return noise2_UnskewedBase(seed, xs, ys);
}

float opensimplex2s_noise2_ImproveX(long seed, double x, double y) {
  double xx = x * ROOT2OVER2;
  double yy = y * (ROOT2OVER2 * (1 + 2 * SKEW_2D));

  return noise2_UnskewedBase(seed, yy + xx, yy - xx);
}

float opensimplex2s_noise3_ImproveXY(long seed, double x, double y, double z);
float opensimplex2s_noise3_ImproveXZ(long seed, double x, double y, double z);
float opensimplex2s_noise3_Fallback(long seed, double x, double y, double z);

float opensimplex2s_noise4_ImproveXYZ_ImproveXY(long seed, double x, double y,
                                                double z, double w);
float opensimplex2s_noise4_ImproveXYZ_ImproveXZ(long seed, double x, double y,
                                                double z, double w);
float opensimplex2s_noise4_ImproveXYZ(long seed, double x, double y, double z,
                                      double w);
float opensimplex2s_noise_ImproveXY_ImproveZW(long seed, double x, double y,
                                              double z, double w);
float opensimplex_noise_Fallback(long seed, double x, double y, double z,
                                 double w);
